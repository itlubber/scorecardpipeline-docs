

<!DOCTYPE html>
<html class="no-js" lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="scorecardpipeline" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="0.1.35" />
    <meta name="docsearch:version" content="" />
    
      <title>sklearn.feature_selection._rfe &mdash; scorecardpipeline 0.1.35 文档</title>
    
    <link rel="stylesheet" href="../../../_static/bootstrap-icons.css" type="text/css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
          <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../../_static/pygments_dark.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/colorsets/sphinx-nefertiti-indigo.min.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/fonts/nunito/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/fonts/red-hat-mono/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/fonts/nunito/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/fonts/nunito/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/fonts/nunito/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../../_static/pygments_dark.css" />
        <link rel="index" title="索引" href="../../../genindex.html" />
        <link rel="search" title="搜索" href="../../../search.html" />
        <link rel="top" title="scorecardpipeline 0.1.35 文档" href="#" />
        <link rel="up" title="模块代码" href="../../index.html" />
    <style>
      :root {
        --nftt-body-font-family: "Nunito", var(--nftt-font-sans-serif) !important;
        --nftt-font-monospace: "Red Hat Mono", var(--nftt-font-family-monospace) !important;
        --nftt-project-name-font: "Nunito", var(--nftt-body-font-family);
        --nftt-documentation-font: "Nunito", var(--nftt-body-font-family);
        --nftt-doc-headers-font: "Nunito", var(--nftt-documentation-font);}
      h1 *, h2 *, h3 *, h4 *, h5 *, h6 * { font-size: inherit; }
    </style>
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark nftt-navbar flex-column fixed-top">
      <div class="skip-links container-xxl visually-hidden-focusable overflow-hidden justify-content-start">
        <div class="border-bottom mb-2 pb-2 w-100">
          <a class="d-none d-md-inline-flex p-2 m-1" href="#sidebar-filter">Skip to docs navigation</a>
          <a class="d-inline-flex p-2 m-1" href="#content">Skip to main content</a>
        </div>
      </div>
      <nav class="container-xxl nftt-gutter flex-wrap flex-lg-nowrap" aria-label="Main navigation">
        <div class="nftt-navbar-toggler">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle documentation navigation">
            <i class="bi bi-list"></i>
          </button>
        </div>
          <a href="../../../index.html"
              
              class="navbar-brand p-0 me-0 md-lg-2"
          ><span class="brand-text">scorecardpipeline</span></a>
        
        <div class="d-flex d-lg-none">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttSearch" aria-controls="nfttSearch" aria-label="Search">
            <i class="bi bi-search"></i>
          </button>
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttNavbar" aria-controls="nfttNavbar" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
        </div>
        
<div class="offcanvas-lg offcanvas-end flex-grow-1" tabindex="-1" id="nfttSearch" aria-labelledby="nfttSearchOffcanvasLabel" data-bs-scroll="true">
  <div class="offcanvas-header px-4 pb-0">
    <h5 class="offcanvas-title fw-bold" id="nfttSearchOffcanvasLabel">Search the documentation</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttSearch"></button>
  </div>
  <div class="offcanvas-body p-4 pt-0 p-lg-0 px-lg-3">
    <hr class="d-lg-none text-white-50">
    <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
      <li class="nav-item col-12 col-lg-auto">
        <form id="nftt-search-form" action="../../../search.html" method="get">
          <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Search docs" aria-label="Search" aria-describedby="button-search">
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <button class="btn btn-primary" type="submit" id="button-search" aria-label="Search"><i class="bi bi-search"></i></button>
          </div>
        </form>
      </li>
    </ul>
  </div>
</div>

        <div class="offcanvas-lg offcanvas-end" tabindex="-1" id="nfttNavbar" aria-labelledby="nfttNavbarOffcanvasLabel" data-bs-scroll="true">
          <div class="offcanvas-header px-4 pb-0">
            <div class="offcanvas-title text-white fw-bold" id="nfttNavbarOffcanvasLabel"><span class="brand-text">Nefertiti for Sphinx</span></div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttNavbar"></button>
          </div>
          <div class="offcanvas-body p-4 pt-0 p-lg-0">
            <hr class="d-lg-none text-white-50">
            <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
              
              <li class="nav-item col-12 col-lg-auto">
                <a class="nav-link py-2 py-lg-0 px-0 px-lg-2" href="https://github.com/itlubber/scorecardpipeline" target="_blank" rel="noopener">
                  <div class="d-flex align-items-center">
                    <div class="me-2">
                      <i class="bi bi-git size-24"></i>
                    </div>
                    <div class="repo d-flex flex-column align-items-center" data-snftt-repo-url="https://github.com/itlubber/scorecardpipeline">
                      itlubber/scorecardpipeline
                      <div class="d-flex justify-content-center" data-snftt-repo-metrics>
                        <span class="pe-2 d-flex justify-content-center align-items-center">
                          <i class="bi bi-tag size-14"></i>
                          <span class="repo-metric" data-snftt-repo-tag></span>
                        </span>
                        <span class="pe-2 d-flex justify-content-center align-items-center">
                          <i class="bi bi-star size-14"></i>
                          <span class="repo-metric" data-snftt-repo-stars></span>
                        </span>
                        <span class="d-flex justify-content-center align-items-center">
                          <i class="bi bi-diagram-2 size-14"></i>
                          <span class="repo-metric" data-snftt-repo-forks></span>
                        </span>
                      </div>
                    </div>
                  </div>
                </a>
              </li>
              <li class="nav-item col-12 col-lg-auto h-100" aria-hidden="true">
                <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-white"></div>
                <hr class="d-lg-none text-white-50">
              </li>
              
              <!-- version_dropdown.html -->

  
    <li class="nav-item dropdown">
      <a class="nav-link d-flex py-2 px-0 px-lg-2 dropdown-toggle align-items-center" id="snftt-version" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Select version">
        <span id="snftt-version-text" class="d-lg-none small">scorecardpipeline</span>
        <span class="small ms-2" data-snftt-version-active="v0.1.35">v0.1.35</span>
      </a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="snftt-version-text">
        <li>
          <h6 class="dropdown-header">Versions</h6>
        </li>
        
          <li>
            <a class="dropdown-item d-flex align-items-center justify-content-between" aria-pressed="false" href="https://itlubber.github.io/scorecardpipeline-docs" data-snftt-version-url="https://itlubber.github.io/scorecardpipeline-docs" data-snftt-version="v0.1.35">
              <span class="small ms-2">v0.1.35</span>
              <i class="bi bi-check ms-auto"></i>
            </a>
          </li>
        
      </ul>
    </li>
  

  <li class="nav-item col-12 col-lg-auto h-100" aria-hidden="true">
    <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-white"></div>
    <hr class="d-lg-none text-white-50">
  </li>

              
              <!-- colorscheme_dropdown.html -->
<li class="nav-item dropdown">
  <a class="nav-link d-flex py-2 px-0 px-lg-2 dropdown-toggle align-items-center" id="snftt-luz" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false" aria-label="Toggle light/dark">
    <i class="bi bi-circle-half" data-snftt-luz-icon-active></i>
    <span id="snftt-luz-text" class="d-lg-none small ms-2">Toggle light/dark</span>
  </a>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="snftt-luz-text">
    <li>
      <h6 class="dropdown-header">Light/dark</h6>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="light" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-sun" data-snftt-luz-icon="light"></i>
        </span>
        <span class="small ms-3">Light</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="dark" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-moon-stars" data-snftt-luz-icon="dark"></i>
        </span>
        <span class="small ms-3">Dark</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item current d-flex align-items-center" data-snftt-luz="default" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-circle-half" data-snftt-luz-icon="default"></i>
        </span>
        <span class="small ms-3">Default</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
  </ul>
</li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <div class="container-xxl nftt-gutter nftt-layout">
      <aside class="nftt-sidebar">
        <div class="title d-none d-md-block">
          <i class="bi bi-book"></i>&nbsp;&nbsp;<span>Table of contents</span>
        </div>
        <div id="sidebar" tabindex="-1" class="offcanvas-lg offcanvas-start" aria-labelledby="nfttSidebarOffcanvasLabel">
            <!-- danirus sidebartemplate: "globaltoc.html" --><div class="offcanvas-header border-bottom">
  <h5 class="offcanvas-title" id="nfttSidebarOffcanvasLabel">
    Table of contents
  </h5>
  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#sidebar"></button>
</div>

<div class="offcanvas-body">
  <nav class="toc" aria-label="Main menu">
    <div class="mb-3 p-1 pt-3 pb-4 border-bottom">
      <input id="sidebar-filter" type="text" name="filter" class="form-control form-control-sm" placeholder="filter" aria-label="filter">
    </div>
    <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html#id2">版本说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html#id3">环境安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html#id4">使用示例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html#id16">交流</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html">scorecardpipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.processing">scorecardpipeline.processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.model">scorecardpipeline.model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.auto_eda">scorecardpipeline.auto_eda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.auto_report">scorecardpipeline.auto_report</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.utils">scorecardpipeline.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.excel_writer">scorecardpipeline.excel_writer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.rule">scorecardpipeline.rule</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.rule_extraction">scorecardpipeline.rule_extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scorecardpipeline.html#module-scorecardpipeline.logger">scorecardpipeline.logger</a></li>
</ul>

  </nav>
  <template data-toggle-item-template>
    <button class="btn btn-sm btn-link toctree-expand" type="button">
      <i class="bi bi-caret-right"></i>
      <span class="visually-hidden">Toggle menu contents</span>
    </button>
  </template>
</div>
        </div>
      </aside>
      <main class="nftt-main">
        <article id="content" class="nftt-content" role="main">
    <h1>sklearn.feature_selection._rfe 源代码</h1><div class="highlight"><pre>
<span></span><span class="c1"># Authors: Alexandre Gramfort &lt;alexandre.gramfort@inria.fr&gt;</span>
<span class="c1">#          Vincent Michel &lt;vincent.michel@inria.fr&gt;</span>
<span class="c1">#          Gilles Louppe &lt;g.louppe@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD 3 clause</span>

<span class="sd">&quot;&quot;&quot;Recursive feature elimination for feature ranking&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Integral</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">effective_n_jobs</span>

<span class="kn">from</span> <span class="nn">..base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">MetaEstimatorMixin</span><span class="p">,</span> <span class="n">_fit_context</span><span class="p">,</span> <span class="n">clone</span><span class="p">,</span> <span class="n">is_classifier</span>
<span class="kn">from</span> <span class="nn">..metrics</span> <span class="kn">import</span> <span class="n">check_scoring</span>
<span class="kn">from</span> <span class="nn">..model_selection</span> <span class="kn">import</span> <span class="n">check_cv</span>
<span class="kn">from</span> <span class="nn">..model_selection._validation</span> <span class="kn">import</span> <span class="n">_score</span>
<span class="kn">from</span> <span class="nn">..utils._param_validation</span> <span class="kn">import</span> <span class="n">HasMethods</span><span class="p">,</span> <span class="n">Interval</span><span class="p">,</span> <span class="n">RealNotInt</span>
<span class="kn">from</span> <span class="nn">..utils._tags</span> <span class="kn">import</span> <span class="n">_safe_tags</span>
<span class="kn">from</span> <span class="nn">..utils.metaestimators</span> <span class="kn">import</span> <span class="n">_safe_split</span><span class="p">,</span> <span class="n">available_if</span>
<span class="kn">from</span> <span class="nn">..utils.parallel</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">..utils.validation</span> <span class="kn">import</span> <span class="n">check_is_fitted</span>
<span class="kn">from</span> <span class="nn">._base</span> <span class="kn">import</span> <span class="n">SelectorMixin</span><span class="p">,</span> <span class="n">_get_feature_importances</span>


<span class="k">def</span> <span class="nf">_rfe_single_fit</span><span class="p">(</span><span class="n">rfe</span><span class="p">,</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">scorer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the score for a fit across one fold.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">_safe_split</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">_safe_split</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rfe</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span>
        <span class="n">X_train</span><span class="p">,</span>
        <span class="n">y_train</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">features</span><span class="p">:</span> <span class="n">_score</span><span class="p">(</span>
            <span class="n">estimator</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[:,</span> <span class="n">features</span><span class="p">],</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scorer</span>
        <span class="p">),</span>
    <span class="p">)</span><span class="o">.</span><span class="n">scores_</span>


<span class="k">def</span> <span class="nf">_estimator_has</span><span class="p">(</span><span class="n">attr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if we can delegate a method to the underlying estimator.</span>

<span class="sd">    First, we check the first fitted estimator if available, otherwise we</span>
<span class="sd">    check the unfitted estimator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="p">(</span>
        <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;estimator_&quot;</span><span class="p">)</span>
        <span class="k">else</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
    <span class="p">)</span>


<div class="viewcode-block" id="RFE"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE">[文档]</a><span class="k">class</span> <span class="nc">RFE</span><span class="p">(</span><span class="n">SelectorMixin</span><span class="p">,</span> <span class="n">MetaEstimatorMixin</span><span class="p">,</span> <span class="n">BaseEstimator</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Feature ranking with recursive feature elimination.</span>

<span class="sd">    Given an external estimator that assigns weights to features (e.g., the</span>
<span class="sd">    coefficients of a linear model), the goal of recursive feature elimination</span>
<span class="sd">    (RFE) is to select features by recursively considering smaller and smaller</span>
<span class="sd">    sets of features. First, the estimator is trained on the initial set of</span>
<span class="sd">    features and the importance of each feature is obtained either through</span>
<span class="sd">    any specific attribute or callable.</span>
<span class="sd">    Then, the least important features are pruned from current set of features.</span>
<span class="sd">    That procedure is recursively repeated on the pruned set until the desired</span>
<span class="sd">    number of features to select is eventually reached.</span>

<span class="sd">    Read more in the :ref:`User Guide &lt;rfe&gt;`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    estimator : ``Estimator`` instance</span>
<span class="sd">        A supervised learning estimator with a ``fit`` method that provides</span>
<span class="sd">        information about feature importance</span>
<span class="sd">        (e.g. `coef_`, `feature_importances_`).</span>

<span class="sd">    n_features_to_select : int or float, default=None</span>
<span class="sd">        The number of features to select. If `None`, half of the features are</span>
<span class="sd">        selected. If integer, the parameter is the absolute number of features</span>
<span class="sd">        to select. If float between 0 and 1, it is the fraction of features to</span>
<span class="sd">        select.</span>

<span class="sd">        .. versionchanged:: 0.24</span>
<span class="sd">           Added float values for fractions.</span>

<span class="sd">    step : int or float, default=1</span>
<span class="sd">        If greater than or equal to 1, then ``step`` corresponds to the</span>
<span class="sd">        (integer) number of features to remove at each iteration.</span>
<span class="sd">        If within (0.0, 1.0), then ``step`` corresponds to the percentage</span>
<span class="sd">        (rounded down) of features to remove at each iteration.</span>

<span class="sd">    verbose : int, default=0</span>
<span class="sd">        Controls verbosity of output.</span>

<span class="sd">    importance_getter : str or callable, default=&#39;auto&#39;</span>
<span class="sd">        If &#39;auto&#39;, uses the feature importance either through a `coef_`</span>
<span class="sd">        or `feature_importances_` attributes of estimator.</span>

<span class="sd">        Also accepts a string that specifies an attribute name/path</span>
<span class="sd">        for extracting feature importance (implemented with `attrgetter`).</span>
<span class="sd">        For example, give `regressor_.coef_` in case of</span>
<span class="sd">        :class:`~sklearn.compose.TransformedTargetRegressor`  or</span>
<span class="sd">        `named_steps.clf.feature_importances_` in case of</span>
<span class="sd">        class:`~sklearn.pipeline.Pipeline` with its last step named `clf`.</span>

<span class="sd">        If `callable`, overrides the default feature importance getter.</span>
<span class="sd">        The callable is passed with the fitted estimator and it should</span>
<span class="sd">        return importance for each feature.</span>

<span class="sd">        .. versionadded:: 0.24</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    classes_ : ndarray of shape (n_classes,)</span>
<span class="sd">        The classes labels. Only available when `estimator` is a classifier.</span>

<span class="sd">    estimator_ : ``Estimator`` instance</span>
<span class="sd">        The fitted estimator used to select features.</span>

<span class="sd">    n_features_ : int</span>
<span class="sd">        The number of selected features.</span>

<span class="sd">    n_features_in_ : int</span>
<span class="sd">        Number of features seen during :term:`fit`. Only defined if the</span>
<span class="sd">        underlying estimator exposes such an attribute when fit.</span>

<span class="sd">        .. versionadded:: 0.24</span>

<span class="sd">    feature_names_in_ : ndarray of shape (`n_features_in_`,)</span>
<span class="sd">        Names of features seen during :term:`fit`. Defined only when `X`</span>
<span class="sd">        has feature names that are all strings.</span>

<span class="sd">        .. versionadded:: 1.0</span>

<span class="sd">    ranking_ : ndarray of shape (n_features,)</span>
<span class="sd">        The feature ranking, such that ``ranking_[i]`` corresponds to the</span>
<span class="sd">        ranking position of the i-th feature. Selected (i.e., estimated</span>
<span class="sd">        best) features are assigned rank 1.</span>

<span class="sd">    support_ : ndarray of shape (n_features,)</span>
<span class="sd">        The mask of selected features.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    RFECV : Recursive feature elimination with built-in cross-validated</span>
<span class="sd">        selection of the best number of features.</span>
<span class="sd">    SelectFromModel : Feature selection based on thresholds of importance</span>
<span class="sd">        weights.</span>
<span class="sd">    SequentialFeatureSelector : Sequential cross-validation based feature</span>
<span class="sd">        selection. Does not rely on importance weights.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Allows NaN/Inf in the input if the underlying estimator does as well.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] Guyon, I., Weston, J., Barnhill, S., &amp; Vapnik, V., &quot;Gene selection</span>
<span class="sd">           for cancer classification using support vector machines&quot;,</span>
<span class="sd">           Mach. Learn., 46(1-3), 389--422, 2002.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The following example shows how to retrieve the 5 most informative</span>
<span class="sd">    features in the Friedman #1 dataset.</span>

<span class="sd">    &gt;&gt;&gt; from sklearn.datasets import make_friedman1</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.feature_selection import RFE</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.svm import SVR</span>
<span class="sd">    &gt;&gt;&gt; X, y = make_friedman1(n_samples=50, n_features=10, random_state=0)</span>
<span class="sd">    &gt;&gt;&gt; estimator = SVR(kernel=&quot;linear&quot;)</span>
<span class="sd">    &gt;&gt;&gt; selector = RFE(estimator, n_features_to_select=5, step=1)</span>
<span class="sd">    &gt;&gt;&gt; selector = selector.fit(X, y)</span>
<span class="sd">    &gt;&gt;&gt; selector.support_</span>
<span class="sd">    array([ True,  True,  True,  True,  True, False, False, False, False,</span>
<span class="sd">           False])</span>
<span class="sd">    &gt;&gt;&gt; selector.ranking_</span>
<span class="sd">    array([1, 1, 1, 1, 1, 6, 4, 3, 2, 5])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_parameter_constraints</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;estimator&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">HasMethods</span><span class="p">([</span><span class="s2">&quot;fit&quot;</span><span class="p">])],</span>
        <span class="s2">&quot;n_features_to_select&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">Interval</span><span class="p">(</span><span class="n">RealNotInt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">),</span>
            <span class="n">Interval</span><span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;neither&quot;</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">Interval</span><span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;neither&quot;</span><span class="p">),</span>
            <span class="n">Interval</span><span class="p">(</span><span class="n">RealNotInt</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;neither&quot;</span><span class="p">),</span>
        <span class="p">],</span>
        <span class="s2">&quot;verbose&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;verbose&quot;</span><span class="p">],</span>
        <span class="s2">&quot;importance_getter&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">callable</span><span class="p">],</span>
    <span class="p">}</span>

<div class="viewcode-block" id="RFE.__init__"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">n_features_to_select</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">importance_getter</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">estimator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span> <span class="o">=</span> <span class="n">n_features_to_select</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importance_getter</span> <span class="o">=</span> <span class="n">importance_getter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_estimator_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">_estimator_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">classes_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classes labels available when `estimator` is a classifier.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ndarray of shape (n_classes,)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">classes_</span>

<div class="viewcode-block" id="RFE.fit"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.fit">[文档]</a>    <span class="nd">@_fit_context</span><span class="p">(</span>
        <span class="c1"># RFE.estimator is not validated yet</span>
        <span class="n">prefer_skip_nested_validation</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the RFE model and then the underlying estimator on the selected features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
<span class="sd">            The training input samples.</span>

<span class="sd">        y : array-like of shape (n_samples,)</span>
<span class="sd">            The target values.</span>

<span class="sd">        **fit_params : dict</span>
<span class="sd">            Additional parameters passed to the `fit` method of the underlying</span>
<span class="sd">            estimator.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : object</span>
<span class="sd">            Fitted estimator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">step_score</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
        <span class="c1"># Parameter step_score controls the calculation of self.scores_</span>
        <span class="c1"># step_score is not exposed to users</span>
        <span class="c1"># and is used when implementing RFECV</span>
        <span class="c1"># self.scores_ will not be calculated when calling _fit through fit</span>

        <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tags</span><span class="p">()</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span>
            <span class="n">X</span><span class="p">,</span>
            <span class="n">y</span><span class="p">,</span>
            <span class="n">accept_sparse</span><span class="o">=</span><span class="s2">&quot;csc&quot;</span><span class="p">,</span>
            <span class="n">ensure_min_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">force_all_finite</span><span class="o">=</span><span class="ow">not</span> <span class="n">tags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;allow_nan&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="n">multi_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Initialization</span>
        <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="n">n_features</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span><span class="p">,</span> <span class="n">Integral</span><span class="p">):</span>  <span class="c1"># int</span>
            <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># float</span>
            <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_features</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features_to_select</span><span class="p">)</span>

        <span class="k">if</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">*</span> <span class="n">n_features</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

        <span class="n">support_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">ranking_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_features</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">step_score</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Elimination</span>
        <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">support_</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">n_features_to_select</span><span class="p">:</span>
            <span class="c1"># Remaining features</span>
            <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_features</span><span class="p">)[</span><span class="n">support_</span><span class="p">]</span>

            <span class="c1"># Rank the remaining features</span>
            <span class="n">estimator</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fitting estimator with </span><span class="si">%d</span><span class="s2"> features.&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">support_</span><span class="p">))</span>

            <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">features</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>

            <span class="c1"># Get importance and rank them</span>
            <span class="n">importances</span> <span class="o">=</span> <span class="n">_get_feature_importances</span><span class="p">(</span>
                <span class="n">estimator</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">importance_getter</span><span class="p">,</span>
                <span class="n">transform_func</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">importances</span><span class="p">)</span>

            <span class="c1"># for sparse case ranks is matrix</span>
            <span class="n">ranks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">ranks</span><span class="p">)</span>

            <span class="c1"># Eliminate the worse features</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">support_</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_features_to_select</span><span class="p">)</span>

            <span class="c1"># Compute step score on the previous selection iteration</span>
            <span class="c1"># because &#39;estimator&#39; must use features</span>
            <span class="c1"># that have not been eliminated yet</span>
            <span class="k">if</span> <span class="n">step_score</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step_score</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">features</span><span class="p">))</span>
            <span class="n">support_</span><span class="p">[</span><span class="n">features</span><span class="p">[</span><span class="n">ranks</span><span class="p">][:</span><span class="n">threshold</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">ranking_</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">support_</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Set final attributes</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_features</span><span class="p">)[</span><span class="n">support_</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="n">features</span><span class="p">],</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span>

        <span class="c1"># Compute step score when only n_features_to_select features left</span>
        <span class="k">if</span> <span class="n">step_score</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scores_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step_score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="p">,</span> <span class="n">features</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features_</span> <span class="o">=</span> <span class="n">support_</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support_</span> <span class="o">=</span> <span class="n">support_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranking_</span> <span class="o">=</span> <span class="n">ranking_</span>

        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="RFE.predict"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.predict">[文档]</a>    <span class="nd">@available_if</span><span class="p">(</span><span class="n">_estimator_has</span><span class="p">(</span><span class="s2">&quot;predict&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce X to the selected features and predict using the estimator.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array of shape [n_samples, n_features]</span>
<span class="sd">            The input samples.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        y : array of shape [n_samples]</span>
<span class="sd">            The predicted target values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></div>

<div class="viewcode-block" id="RFE.score"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.score">[文档]</a>    <span class="nd">@available_if</span><span class="p">(</span><span class="n">_estimator_has</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reduce X to the selected features and return the score of the estimator.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array of shape [n_samples, n_features]</span>
<span class="sd">            The input samples.</span>

<span class="sd">        y : array of shape [n_samples]</span>
<span class="sd">            The target values.</span>

<span class="sd">        **fit_params : dict</span>
<span class="sd">            Parameters to pass to the `score` method of the underlying</span>
<span class="sd">            estimator.</span>

<span class="sd">            .. versionadded:: 1.0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        score : float</span>
<span class="sd">            Score of the underlying base estimator computed with the selected</span>
<span class="sd">            features returned by `rfe.transform(X)` and `y`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_get_support_mask</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">support_</span>

<div class="viewcode-block" id="RFE.decision_function"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.decision_function">[文档]</a>    <span class="nd">@available_if</span><span class="p">(</span><span class="n">_estimator_has</span><span class="p">(</span><span class="s2">&quot;decision_function&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">decision_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the decision function of ``X``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : {array-like or sparse matrix} of shape (n_samples, n_features)</span>
<span class="sd">            The input samples. Internally, it will be converted to</span>
<span class="sd">            ``dtype=np.float32`` and if a sparse matrix is provided</span>
<span class="sd">            to a sparse ``csr_matrix``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        score : array, shape = [n_samples, n_classes] or [n_samples]</span>
<span class="sd">            The decision function of the input samples. The order of the</span>
<span class="sd">            classes corresponds to that in the attribute :term:`classes_`.</span>
<span class="sd">            Regression and binary classification produce an array of shape</span>
<span class="sd">            [n_samples].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></div>

<div class="viewcode-block" id="RFE.predict_proba"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.predict_proba">[文档]</a>    <span class="nd">@available_if</span><span class="p">(</span><span class="n">_estimator_has</span><span class="p">(</span><span class="s2">&quot;predict_proba&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class probabilities for X.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : {array-like or sparse matrix} of shape (n_samples, n_features)</span>
<span class="sd">            The input samples. Internally, it will be converted to</span>
<span class="sd">            ``dtype=np.float32`` and if a sparse matrix is provided</span>
<span class="sd">            to a sparse ``csr_matrix``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        p : array of shape (n_samples, n_classes)</span>
<span class="sd">            The class probabilities of the input samples. The order of the</span>
<span class="sd">            classes corresponds to that in the attribute :term:`classes_`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></div>

<div class="viewcode-block" id="RFE.predict_log_proba"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFE.predict_log_proba">[文档]</a>    <span class="nd">@available_if</span><span class="p">(</span><span class="n">_estimator_has</span><span class="p">(</span><span class="s2">&quot;predict_log_proba&quot;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">predict_log_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict class log-probabilities for X.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : array of shape [n_samples, n_features]</span>
<span class="sd">            The input samples.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        p : array of shape (n_samples, n_classes)</span>
<span class="sd">            The class log-probabilities of the input samples. The order of the</span>
<span class="sd">            classes corresponds to that in the attribute :term:`classes_`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">check_is_fitted</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">predict_log_proba</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">_more_tags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;poor_score&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;allow_nan&quot;</span><span class="p">:</span> <span class="n">_safe_tags</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s2">&quot;allow_nan&quot;</span><span class="p">),</span>
            <span class="s2">&quot;requires_y&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RFECV"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFECV">[文档]</a><span class="k">class</span> <span class="nc">RFECV</span><span class="p">(</span><span class="n">RFE</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursive feature elimination with cross-validation to select features.</span>

<span class="sd">    See glossary entry for :term:`cross-validation estimator`.</span>

<span class="sd">    Read more in the :ref:`User Guide &lt;rfe&gt;`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    estimator : ``Estimator`` instance</span>
<span class="sd">        A supervised learning estimator with a ``fit`` method that provides</span>
<span class="sd">        information about feature importance either through a ``coef_``</span>
<span class="sd">        attribute or through a ``feature_importances_`` attribute.</span>

<span class="sd">    step : int or float, default=1</span>
<span class="sd">        If greater than or equal to 1, then ``step`` corresponds to the</span>
<span class="sd">        (integer) number of features to remove at each iteration.</span>
<span class="sd">        If within (0.0, 1.0), then ``step`` corresponds to the percentage</span>
<span class="sd">        (rounded down) of features to remove at each iteration.</span>
<span class="sd">        Note that the last iteration may remove fewer than ``step`` features in</span>
<span class="sd">        order to reach ``min_features_to_select``.</span>

<span class="sd">    min_features_to_select : int, default=1</span>
<span class="sd">        The minimum number of features to be selected. This number of features</span>
<span class="sd">        will always be scored, even if the difference between the original</span>
<span class="sd">        feature count and ``min_features_to_select`` isn&#39;t divisible by</span>
<span class="sd">        ``step``.</span>

<span class="sd">        .. versionadded:: 0.20</span>

<span class="sd">    cv : int, cross-validation generator or an iterable, default=None</span>
<span class="sd">        Determines the cross-validation splitting strategy.</span>
<span class="sd">        Possible inputs for cv are:</span>

<span class="sd">        - None, to use the default 5-fold cross-validation,</span>
<span class="sd">        - integer, to specify the number of folds.</span>
<span class="sd">        - :term:`CV splitter`,</span>
<span class="sd">        - An iterable yielding (train, test) splits as arrays of indices.</span>

<span class="sd">        For integer/None inputs, if ``y`` is binary or multiclass,</span>
<span class="sd">        :class:`~sklearn.model_selection.StratifiedKFold` is used. If the</span>
<span class="sd">        estimator is a classifier or if ``y`` is neither binary nor multiclass,</span>
<span class="sd">        :class:`~sklearn.model_selection.KFold` is used.</span>

<span class="sd">        Refer :ref:`User Guide &lt;cross_validation&gt;` for the various</span>
<span class="sd">        cross-validation strategies that can be used here.</span>

<span class="sd">        .. versionchanged:: 0.22</span>
<span class="sd">            ``cv`` default value of None changed from 3-fold to 5-fold.</span>

<span class="sd">    scoring : str, callable or None, default=None</span>
<span class="sd">        A string (see model evaluation documentation) or</span>
<span class="sd">        a scorer callable object / function with signature</span>
<span class="sd">        ``scorer(estimator, X, y)``.</span>

<span class="sd">    verbose : int, default=0</span>
<span class="sd">        Controls verbosity of output.</span>

<span class="sd">    n_jobs : int or None, default=None</span>
<span class="sd">        Number of cores to run in parallel while fitting across folds.</span>
<span class="sd">        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.</span>
<span class="sd">        ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span>
<span class="sd">        for more details.</span>

<span class="sd">        .. versionadded:: 0.18</span>

<span class="sd">    importance_getter : str or callable, default=&#39;auto&#39;</span>
<span class="sd">        If &#39;auto&#39;, uses the feature importance either through a `coef_`</span>
<span class="sd">        or `feature_importances_` attributes of estimator.</span>

<span class="sd">        Also accepts a string that specifies an attribute name/path</span>
<span class="sd">        for extracting feature importance.</span>
<span class="sd">        For example, give `regressor_.coef_` in case of</span>
<span class="sd">        :class:`~sklearn.compose.TransformedTargetRegressor`  or</span>
<span class="sd">        `named_steps.clf.feature_importances_` in case of</span>
<span class="sd">        :class:`~sklearn.pipeline.Pipeline` with its last step named `clf`.</span>

<span class="sd">        If `callable`, overrides the default feature importance getter.</span>
<span class="sd">        The callable is passed with the fitted estimator and it should</span>
<span class="sd">        return importance for each feature.</span>

<span class="sd">        .. versionadded:: 0.24</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    classes_ : ndarray of shape (n_classes,)</span>
<span class="sd">        The classes labels. Only available when `estimator` is a classifier.</span>

<span class="sd">    estimator_ : ``Estimator`` instance</span>
<span class="sd">        The fitted estimator used to select features.</span>

<span class="sd">    cv_results_ : dict of ndarrays</span>
<span class="sd">        A dict with keys:</span>

<span class="sd">        split(k)_test_score : ndarray of shape (n_subsets_of_features,)</span>
<span class="sd">            The cross-validation scores across (k)th fold.</span>

<span class="sd">        mean_test_score : ndarray of shape (n_subsets_of_features,)</span>
<span class="sd">            Mean of scores over the folds.</span>

<span class="sd">        std_test_score : ndarray of shape (n_subsets_of_features,)</span>
<span class="sd">            Standard deviation of scores over the folds.</span>

<span class="sd">        .. versionadded:: 1.0</span>

<span class="sd">    n_features_ : int</span>
<span class="sd">        The number of selected features with cross-validation.</span>

<span class="sd">    n_features_in_ : int</span>
<span class="sd">        Number of features seen during :term:`fit`. Only defined if the</span>
<span class="sd">        underlying estimator exposes such an attribute when fit.</span>

<span class="sd">        .. versionadded:: 0.24</span>

<span class="sd">    feature_names_in_ : ndarray of shape (`n_features_in_`,)</span>
<span class="sd">        Names of features seen during :term:`fit`. Defined only when `X`</span>
<span class="sd">        has feature names that are all strings.</span>

<span class="sd">        .. versionadded:: 1.0</span>

<span class="sd">    ranking_ : narray of shape (n_features,)</span>
<span class="sd">        The feature ranking, such that `ranking_[i]`</span>
<span class="sd">        corresponds to the ranking</span>
<span class="sd">        position of the i-th feature.</span>
<span class="sd">        Selected (i.e., estimated best)</span>
<span class="sd">        features are assigned rank 1.</span>

<span class="sd">    support_ : ndarray of shape (n_features,)</span>
<span class="sd">        The mask of selected features.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    RFE : Recursive feature elimination.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The size of all values in ``cv_results_`` is equal to</span>
<span class="sd">    ``ceil((n_features - min_features_to_select) / step) + 1``,</span>
<span class="sd">    where step is the number of features removed at each iteration.</span>

<span class="sd">    Allows NaN/Inf in the input if the underlying estimator does as well.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>

<span class="sd">    .. [1] Guyon, I., Weston, J., Barnhill, S., &amp; Vapnik, V., &quot;Gene selection</span>
<span class="sd">           for cancer classification using support vector machines&quot;,</span>
<span class="sd">           Mach. Learn., 46(1-3), 389--422, 2002.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    The following example shows how to retrieve the a-priori not known 5</span>
<span class="sd">    informative features in the Friedman #1 dataset.</span>

<span class="sd">    &gt;&gt;&gt; from sklearn.datasets import make_friedman1</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.feature_selection import RFECV</span>
<span class="sd">    &gt;&gt;&gt; from sklearn.svm import SVR</span>
<span class="sd">    &gt;&gt;&gt; X, y = make_friedman1(n_samples=50, n_features=10, random_state=0)</span>
<span class="sd">    &gt;&gt;&gt; estimator = SVR(kernel=&quot;linear&quot;)</span>
<span class="sd">    &gt;&gt;&gt; selector = RFECV(estimator, step=1, cv=5)</span>
<span class="sd">    &gt;&gt;&gt; selector = selector.fit(X, y)</span>
<span class="sd">    &gt;&gt;&gt; selector.support_</span>
<span class="sd">    array([ True,  True,  True,  True,  True, False, False, False, False,</span>
<span class="sd">           False])</span>
<span class="sd">    &gt;&gt;&gt; selector.ranking_</span>
<span class="sd">    array([1, 1, 1, 1, 1, 6, 4, 3, 2, 5])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_parameter_constraints</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="o">**</span><span class="n">RFE</span><span class="o">.</span><span class="n">_parameter_constraints</span><span class="p">,</span>
        <span class="s2">&quot;min_features_to_select&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">Interval</span><span class="p">(</span><span class="n">Integral</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="s2">&quot;neither&quot;</span><span class="p">)],</span>
        <span class="s2">&quot;cv&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cv_object&quot;</span><span class="p">],</span>
        <span class="s2">&quot;scoring&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">callable</span><span class="p">],</span>
        <span class="s2">&quot;n_jobs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Integral</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">_parameter_constraints</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;n_features_to_select&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="RFECV.__init__"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFECV.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">estimator</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">min_features_to_select</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cv</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">scoring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">importance_getter</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span> <span class="o">=</span> <span class="n">estimator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">importance_getter</span> <span class="o">=</span> <span class="n">importance_getter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cv</span> <span class="o">=</span> <span class="n">cv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scoring</span> <span class="o">=</span> <span class="n">scoring</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span> <span class="o">=</span> <span class="n">n_jobs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_features_to_select</span> <span class="o">=</span> <span class="n">min_features_to_select</span></div>

<div class="viewcode-block" id="RFECV.fit"><a class="viewcode-back" href="../../../scorecardpipeline.html#scorecardpipeline.RFECV.fit">[文档]</a>    <span class="nd">@_fit_context</span><span class="p">(</span>
        <span class="c1"># RFECV.estimator is not validated yet</span>
        <span class="n">prefer_skip_nested_validation</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Fit the RFE model and automatically tune the number of selected features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        X : {array-like, sparse matrix} of shape (n_samples, n_features)</span>
<span class="sd">            Training vector, where `n_samples` is the number of samples and</span>
<span class="sd">            `n_features` is the total number of features.</span>

<span class="sd">        y : array-like of shape (n_samples,)</span>
<span class="sd">            Target values (integers for classification, real numbers for</span>
<span class="sd">            regression).</span>

<span class="sd">        groups : array-like of shape (n_samples,) or None, default=None</span>
<span class="sd">            Group labels for the samples used while splitting the dataset into</span>
<span class="sd">            train/test set. Only used in conjunction with a &quot;Group&quot; :term:`cv`</span>
<span class="sd">            instance (e.g., :class:`~sklearn.model_selection.GroupKFold`).</span>

<span class="sd">            .. versionadded:: 0.20</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : object</span>
<span class="sd">            Fitted estimator.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_tags</span><span class="p">()</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_data</span><span class="p">(</span>
            <span class="n">X</span><span class="p">,</span>
            <span class="n">y</span><span class="p">,</span>
            <span class="n">accept_sparse</span><span class="o">=</span><span class="s2">&quot;csr&quot;</span><span class="p">,</span>
            <span class="n">ensure_min_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">force_all_finite</span><span class="o">=</span><span class="ow">not</span> <span class="n">tags</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;allow_nan&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
            <span class="n">multi_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Initialization</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">check_cv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cv</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">classifier</span><span class="o">=</span><span class="n">is_classifier</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">))</span>
        <span class="n">scorer</span> <span class="o">=</span> <span class="n">check_scoring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scoring</span><span class="p">)</span>
        <span class="n">n_features</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="mf">0.0</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">*</span> <span class="n">n_features</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

        <span class="c1"># Build an RFE object, which will evaluate and score each possible</span>
        <span class="c1"># feature count, down to self.min_features_to_select</span>
        <span class="n">rfe</span> <span class="o">=</span> <span class="n">RFE</span><span class="p">(</span>
            <span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span>
            <span class="n">n_features_to_select</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">min_features_to_select</span><span class="p">,</span>
            <span class="n">importance_getter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">importance_getter</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Determine the number of subsets of features by fitting across</span>
        <span class="c1"># the train folds and choosing the &quot;features_to_select&quot; parameter</span>
        <span class="c1"># that gives the least averaged error across all folds.</span>

        <span class="c1"># Note that joblib raises a non-picklable error for bound methods</span>
        <span class="c1"># even if n_jobs is set to 1 with the default multiprocessing</span>
        <span class="c1"># backend.</span>
        <span class="c1"># This branching is done so that to</span>
        <span class="c1"># make sure that user code that sets n_jobs to 1</span>
        <span class="c1"># and provides bound methods as scorers is not broken with the</span>
        <span class="c1"># addition of n_jobs parameter in version 0.18.</span>

        <span class="k">if</span> <span class="n">effective_n_jobs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">parallel</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="nb">list</span><span class="p">,</span> <span class="n">_rfe_single_fit</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parallel</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_jobs</span><span class="p">)</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">delayed</span><span class="p">(</span><span class="n">_rfe_single_fit</span><span class="p">)</span>

        <span class="n">scores</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span>
            <span class="n">func</span><span class="p">(</span><span class="n">rfe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">scorer</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">groups</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
        <span class="n">scores_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">scores_sum_rev</span> <span class="o">=</span> <span class="n">scores_sum</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">argmax_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores_sum</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">scores_sum_rev</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">n_features_to_select</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
            <span class="n">n_features</span> <span class="o">-</span> <span class="p">(</span><span class="n">argmax_idx</span> <span class="o">*</span> <span class="n">step</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_features_to_select</span>
        <span class="p">)</span>

        <span class="c1"># Re-execute an elimination with best_k over the whole set</span>
        <span class="n">rfe</span> <span class="o">=</span> <span class="n">RFE</span><span class="p">(</span>
            <span class="n">estimator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">,</span>
            <span class="n">n_features_to_select</span><span class="o">=</span><span class="n">n_features_to_select</span><span class="p">,</span>
            <span class="n">step</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span>
            <span class="n">importance_getter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">importance_getter</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">rfe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># Set final attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">support_</span> <span class="o">=</span> <span class="n">rfe</span><span class="o">.</span><span class="n">support_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features_</span> <span class="o">=</span> <span class="n">rfe</span><span class="o">.</span><span class="n">n_features_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ranking_</span> <span class="o">=</span> <span class="n">rfe</span><span class="o">.</span><span class="n">ranking_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span> <span class="o">=</span> <span class="n">clone</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estimator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">estimator_</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># reverse to stay consistent with before</span>
        <span class="n">scores_rev</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cv_results_</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s2">&quot;mean_test_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores_rev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="s2">&quot;std_test_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">scores_rev</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;split</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_test_score&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores_rev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">self</span></div></div>
</pre></div>
</article>
        
      </main>
    </div>

    <footer class="nftt-footer">
      
<nav id="paginator"></nav>

      <div class="py-5 px-4 px-md-3">
  <div class="container">
    
    <div class="row">
      <ul class="list-unstyled list-separator col-lg-12 pb-2 text-center">
        
          
          
          <li class="d-inline">
            <a href="https://itlubber.art" class="list-item">itlubber</a>
          </li>
        
          
          
          <li class="d-inline">
            <a href="https://github.com/itlubber/scorecardpipeline" class="list-item">github</a>
          </li>
        
          
          
          <li class="d-inline">
            <a href="https://github.com/itlubber/scorecardpipeline/blob/main/examples/scorecard_samples.ipynb" class="list-item">examples</a>
          </li>
        
      </ul>
    </div>
    

    <div class="row">
      <div class="col-lg-12 text-center">
        <a class="brand-text d-inline-flex align-items-center mb-2 text-decoration-none" href="/" aria-label="Nefertiti-for-Sphinx">
          <span class="fs-6 fw-bold">scorecardpipeline</span>
        </a>
        
          <ul class="list-unstyled small text-muted">
            <li>2023, itlubber</li>
          </ul>
        
        
      </div>
    </div>
  </div>
</div>
    </footer>
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/translations.js"></script>
    <script src="../../../_static/design-tabs.js"></script>

    <script type="text/javascript" src="../../../_static/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="../../../_static/sphinx-nefertiti.min.js"></script>
    
  </body>
</html>